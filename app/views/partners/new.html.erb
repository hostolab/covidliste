<%= provide(:meta_title, "Devenez partenaires de Covidliste") %>
<%= provide(:meta_description, "Professionnels de santé, inscrivez-vous sur Covidliste.") %>
<%= provide(:meta_image, image_url("meta/partenaires.png")) %>

<% content_for(:append_to_head) do %>
  <meta content="index;follow" name="robots"/>
<% end %>

<div class="container">
  <div class="row">
      <div class="col-12 d-flex flex-column text-center text-md-left flex-md-row align-items-center">
        <div class="rounded p-3 bg-light text-primary mr-3 h2">
          <%= icon("fas", "hospital-user") %>
        </div>
        <h3>
          Vous êtes membre d'un centre de vaccination ou professionnel de santé, devenez partenaire
        </h3>
      </div>
  </div>
  <div class="row mt-4">

    <% if @partner.persisted? %>

      <div class="col-12 col-lg-6 p-5-md p-4">
        <div class="alert alert-success" role="alert">
          Merci ! Vous êtes bien enregistré en tant que professionnel de santé assurant la vaccination sur Covidliste.
          Vous allez recevoir dans quelques instants un email de confirmation qui vous permettra de valider votre
          inscription et d'accéder à votre espace sécurisé.
        </div>
      </div>

    <% else %>
      <div class="col-12 col-lg-6 mb-5 shadow-lg rounded p-5-md p-4">
        <div>
          <h4 class="text-primary font-weight-bold">Inscription en tant que centre de vaccination ou personnel médical</h4>

          <% if @partner.errors.any? %>
            <div class="alert alert-danger mt-4" role="alert">
              <% @partner.errors.full_messages.each do |msg| %>
                <%= msg %><br/>
              <% end %>
            </div>
          <% end %>

          <div class="mt-3">
            <%= simple_form_for @partner do |f| %>
              <%= f.input :name, label: "Nom", error: "Nom requis", placeholder: "Prénom Nom" %>
              <%= f.input :phone_number, label: "Téléphone portable", placeholder: "06 .... (votre téléphone professionnel - pas de ligne fixe)", hint: "Ce numéro ne sera jamais communiqué aux volontaires. " %>
              <%= f.input :email, required: true, placeholder: "votre_email@du_centre_de_vaccination.fr", input_html: {autocomplete: "email"}, hint: "Cet email ne sera jamais communiqué aux volontaires." %>

              <div class="form-group" data-controller="password">
                <label for="partner_password"> Mot de passe </label>

                <div class="input-group" data-behavior="toggle-password-visibility">
                  <%= f.input_field :password,
                    type: :password,
                    class: "form-control",
                    required: true,
                    input_html: {autocomplete: "new-password"},
                    data: {password_target: 'password', action: 'input->password#check'} %>

                  <div class="input-group-append">
                    <span class="input-group-text"> <%= link_to icon("fas", "eye") %> </span>
                  </div>

                  <small class="form-text text-muted">
                    <%= User::PASSWORD_HINT.to_s %>
                    <br/>
                    <%= content_tag :span, "", data: {password_target: "passwordCheck"}, class: "d-inline-block" %>
                  </small>
                  <small class="form-text text-muted">
                    Un email de confirmation de création de compte vous sera envoyé. Cliquez sur le lien pour activer
                    votre compte.
                  </small>
                </div>
              </div>

              <%= render partial: "users/input_statement", locals: {f: f, local_cgu_path: cgu_pro_path} %>

              <%= f.invisible_captcha :subtitle, honeypots: true %>
              <%= f.button :submit, "Je m'inscris en tant que partenaire", id: "create-new-partner", class: "btn btn-primary font-weight-bold w-100 text-center", data: {disable_with: "Validation...", confirm: "Vous êtes bien professionnel de santé ?"} %>
              
            <% end %>

            <p class="mt-3">
              Déjà inscrit ? <%= link_to "Se connecter en tant que partenaire", new_partner_session_path %>
            </p>

            <small class="text-muted">
              <%= render partial: "mentions" %>
            </small>
          </div>
        </div>

      </div>

    <% end %>

    <div class="col-12 col-lg-6 d-flex flex-column align-items-center p-0 pl-lg-5">
      <div class="border rounded p-5-md p-4">
        <h4 class="font-weight-bold text-primary">Vous êtes un particulier ?</h4>
        <p>Vous souhaitez vous inscrire en tant que volontaire pour recevoir une dose de vaccin ? C'est par ici :</p>
        <div class="btn btn-secondary font-weight-bold">
          <%= link_to "S'inscrire en tant que volontaire", root_path, class: "text-white text-decoration-none" %>
        </div>
      </div>
    </div>
  </div>
</div>
