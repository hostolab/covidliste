<% content_for(:append_to_head) do %>
  <meta content="index;follow" name="robots"/>
<% end %>

<div class="container my-5">

  <% if @partner.errors.any? %>
    <div class="alert alert-danger" role="alert">
      <% @partner.errors.full_messages.each do |msg| %>
        <%= msg %><br />
      <% end %>
    </div>
  <% end %>

  <h1 class="h3">Inscription en tant que professionnel de santé assurant la vaccination</h1>
  
  <p class="text-justify mb-4">
    Cette page d’inscription concerne uniquement l’inscription du <strong><u>personnel médical assurant la vaccination</u> :</strong><br>
    membre d’un centre de vaccination, cabinet de médecine libérale, hôpital, pharmacie...
  </p>

  <div class="card card-theme">
    <div class="card-body">
      <div class="row">
        <div class="col-12 col-md-2 mb-3 mb-md-0 d-flex align-items-center justify-content-center">
          <%= icon("far", "user", class: "fa-3x mr-3") %>
          <%= icon("fas", "syringe", class: "fa-3x") %>
        </div>
        <div class="col-12 col-md-10">
          <%= link_to new_user_path, class: "btn btn-primary py-3 px-4 font-weight-bold", role: "button" do %>
            Je suis volontaire pour me faire vacciner en tant que particulier
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="card card-theme mt-4">
    <div class="card-body">
      <div class="row">
        <div class="col-12 col-md-2 mb-3 mb-md-0 d-flex align-items-center justify-content-center">
          <%= icon("fas", "user-md", class: "fa-3x mr-3") %>
          <%= icon("fas", "clinic-medical", class: "fa-3x") %>
        </div>
        <div class="col-12 col-md-10">
          <% if @partner.persisted? %>
            <div class="alert alert-success mb-0" role="alert">
              Merci ! Vous êtes bien enregistré en tant que professionnel de santé assurant la vaccination sur Covidliste. Vous allez recevoir dans quelques instants un email de confirmation qui vous permettra de valider votre inscription et d'accéder à votre espace sécurisé.
            </div>
          <% else %>
            <div>
              <button class="btn btn-primary py-3 px-4 font-weight-bold text-md-left" type="button" id="health-professionnal" data-toggle="collapse" data-target="#collapseForm" aria-expanded="false" aria-controls="collapseForm">
                Je suis professionnel de santé assurant la vaccination
              </button>
            </div>
          <% end %>
        </div>
      </div>
    </div>
    <% unless @partner.persisted? %>
      <div class="collapse <%= @partner.errors.any? ? 'show' : '' %>" id="collapseForm">
        <div class="card-header border-top font-weight-bold text-primary">
          Formulaire d'inscription
        </div>
        <div class="card-body">
          <p>Veuillez remplir le formulaire ci-dessous pour vous inscrire en tant que <strong><u>professionnel de santé</u></strong>.</p>
          <%= simple_form_for @partner do |f| %>
            <%= f.input :name, label: "Nom", error: "Nom requis", placeholder: "Prénom Nom" %>
            <%= f.input :phone_number, label: "Téléphone portable", placeholder: "06 .... (votre téléphone professionnel)" %>
            <%= f.input :email, required: true, placeholder: "votre_email@du_centre_de_vaccination.fr", input_html: { autocomplete: "email" } %>

            <div class="form-group">
              <label for="partner_password">Mot de passe </label>

              <div class="input-group" data-behavior="toggle-password-visibility">
                <%= f.input_field :password,
                                  type: :password,
                                  class: "form-control",
                                  required: true,
                                  pattern: ".{" + Devise.password_length.min.to_s + ",}",
                                  input_html: { autocomplete: "new-password" } %>

                <div class="input-group-append">
                  <span class="input-group-text"> <%= link_to icon("fas", "eye") %> </span>
                </div>

              </div>
              <div class="small form-text text-muted">
                Un email de confirmation de création de compte vous sera envoyé. Cliquez sur le lien pour activer votre compte.
              </div>
            </div>

            <%= f.invisible_captcha :subtitle, honeypots: true %>
            <%= f.button :submit, "S’inscrire", id: "create-new-partner", class: "btn btn-primary btn-block mb-2", data: { disable_with: "Validation...", confirm: "Vous êtes bien professionnel de santé ?" } %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <p class="mt-3">
    <%= link_to "Se connecter en tant que professionnel de santé assurant la vaccination", new_partner_session_path, class: "text-decoration-underline" %>
  </p>
</div>
