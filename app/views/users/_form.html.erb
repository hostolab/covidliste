
<% if @user.persisted? %>

  <div class="alert alert-success p-3">
    Merci ! Vous êtes bien enregistré sur Covidliste. Vous allez recevoir dans quelques instants un email de
    confirmation qui vous permettra de valider votre inscription et accéder à votre espace sécurisé.
    Le lien de confirmation sera valable pendant 24 heures.
  </div>

<% else %>

  <div class="bg-white p-2 p-lg-4 rounded">

    <% if @user.present? && @user.errors.any? %>
      <div class="alert alert-danger" role="alert" style="position: inherit">
        <% @user.errors.full_messages.each do |msg| %>
          <%= msg %><br />
        <% end %>
      </div>
    <% end %>

    <%= simple_form_for @user do |f| %>
      <%= f.input :birthdate,
                  as: :date,
                  label: false,
                  order: [:day, :month, :year],
                  wrapper_html: { class: "mb-2" } %>
      <p class="text-dark">
        Votre date de naissance sera vérifiée lors du rendez-vous.
      </p>

      <%= f.input :address,
                  label: false,
                  error: "Adresse invalide",
                  placeholder: "Adresse",
                  required: true %>
      <%= f.input_field :lat, as: :hidden %>
      <%= f.input_field :lon, as: :hidden %>

      <%= f.input :phone_number,
                  label: false,
                  error: "Numéro de téléphone invalide",
                  placeholder: "Téléphone",
                  required: true,
                  input_html: { autocomplete: "tel" } %>

      <%= f.input :email,
                  label: false,
                  error: f.error(:email),
                  placeholder: "jean@dupont.com",
                  hint: "Une adresse email ne peut être utilisée que par une seule personne.",
                  required: true,
                  input_html: { autocomplete: "email" } %>

      <%= render partial: "users/input_statement", locals: {f: f, local_cgu_path: cgu_volontaires_path} %>
      <%= render partial: "users/input_toc", locals: {f: f}%>

      <%= f.invisible_captcha :subtitle %>
      <%= f.button :submit, "S’inscrire", class: "btn btn-primary btn-lg btn-block font-weight-bold", data: { disable_with: "Inscription en cours..." } %>
    <% end %>

  </div>
  <div class="py-1 px-2">
    <%= render partial: "users/mentions" %>
  </div>
<% end %>