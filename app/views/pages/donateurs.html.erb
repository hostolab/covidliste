<%= content_for(:append_to_head) do %>
<meta content="index;follow" name="robots"/>
<% end %>

<div class="container my-5">
  <h1 class="mb-3">Donateurs</h1>

  <p class="text-justify text-sm-left">Merci à tous les donateurs qui nous permettent de continuer à former de nouveaux centres partenaires, d'améliorer la plateforme et d'accéler la campagne de vaccination.</p>

  <%= link_to "En savoir plus sur la campagne", @ulule_project["absolute_url"], target: "_blank", rel: "noopener", class: "btn btn-info btn-primary " %>
  <% unless @ulule_project["finished"] %>
    <% if @ulule_project["urls"].present? %>
      <%= link_to "Contribuer financièrement", @ulule_project["urls"]["web"]["checkout"], target: "_blank", rel: "noopener", class: "btn btn-large btn-warning mt-2 mt-md-0 ml-md-2" %>
    <% end %>
  <% end %>

  <% if @ulule_project["goal"].present? %>
    <div class="card my-4">
      <div class="card-body p-3">
        <div class="d-flex align-items-start align-items-sm-center flex-column flex-sm-row mb-2">
          <% if @ulule_project["date_end"].present? %>
            <span class="badge badge-primary mr-2"><%= distance_of_time_in_words(@ulule_project["date_end"].to_time.to_i - Time.zone.now.to_i) %> restant</span>
          <% end %>
          <div class="font-weight-bold text-primary mt-2 mt-sm-0">Objectif: <%= [@ulule_project["goal"], @ulule_project["currency"]].join(" ") %></div>
        </div>
        <div class="d-flex align-items-center">
          <span class="text-primary font-weight-bold mr-2"><%= @ulule_project["percent"] %>%</span>
          <div class="progress-bg rounded">
            <div class="progress-bar rounded" style="width: <%= @ulule_project["percent"] %>%">
              <div class="raised"><%= [@ulule_project["amount_raised"], @ulule_project["currency"]].join(" ") %> levée</div>
            </div>
          </div>
        </div>
        <% if @ulule_project["goal_raised"] %>
          <div class="d-flex align-items-center alert alert-success font-weight-bold mb-0 mt-3 rounded-0">
            <%= icon("fas", "thumbs-up", class: "fa-3x text-success mr-4") %>
            <div class="mb-0">
              Grâce à vous, nous avons dépassé notre objectif.
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>

  <% if @ulule_project["sponsorships_count"].present? && @ulule_project["sponsorships_count"] > 0 %>
    <p>
      Nous tenons à remercier infiniment nos sponsors également.
    </p>
  <% end %>
  
  <% if @ulule_project["supporters_count"].present? && @ulule_project["supporters_count"] > 0 %>
    <div class="font-weight-light text-center text-sm-left text-primary h2 my-5">
      Merci à nos <%= @ulule_project["supporters_count"] %> <%= @ulule_project["supporters_count"] > 1 ? "donateurs" : "donateur" %>
    </div>
  <% end %>

  <% if @ulule_donors["supporters"].present? %>
    <div class="row my-3">
      <% @ulule_donors["supporters"].each do |supporter| %>
        <div class="col-6 col-lg-2 text-center mb-5">
          <div data-toggle="tooltip" data-placement="top" title="<%= supporter["username"] %>">
            <div>
              <%= image_tag supporter["avatar"]["versions"]["128x128"]["url"], height: supporter["avatar"]["versions"]["128x128"]["height"], width: supporter["avatar"]["versions"]["128x128"]["width"], loading: "lazy", class: "rounded-circle border", alt: supporter["name"] %>
            </div>
            <div class="mt-3"><%= supporter["name"] %></div>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
